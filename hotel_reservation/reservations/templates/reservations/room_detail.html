{% extends 'reservations/base.html' %}
{% block content %}

<h1>Room {{ room.room_number }}</h1>
<div class="card mb-4">
    {% if room.image %}
    <img src="{{ room.image.url }}" class="card-img-top" alt="{{ room.room_number }}">
    {% endif %}
    <div class="card-body">
        <h5 class="card-title">{{ room.category.name }}</h5>
        <p class="card-text">Base Price: ${{ room.category.base_price }}</p>
    </div>
</div>

<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#availabilityModal">
    Check Availability
</button>
<button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#reservationModal">
    Book Now
</button>

<!-- Availability Modal -->
<div class="modal fade" id="availabilityModal" tabindex="-1" aria-labelledby="availabilityModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="availabilityModalLabel">Check Availability</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form method="post" action="{% url 'check_availability' %}">
                    {% csrf_token %}
                    {{ availability_form.as_p }}
                    <input type="hidden" name="room_id" value="{{ room.id }}">
                    <button type="submit" class="btn btn-primary">Check Availability</button>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Reservation Modal -->
<div class="modal fade" id="reservationModal" tabindex="-1" aria-labelledby="reservationModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="reservationModalLabel">Create Reservation</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form method="post" action="{% url 'reservation_create' room.id %}">
                    {% csrf_token %}
                    {{ reservation_form.as_p }}
                    <button type="submit" class="btn btn-primary">Create Reservation</button>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

{% endblock %}
